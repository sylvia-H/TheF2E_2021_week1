<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>台灣走走．Tai Walk</title>
    <link
      href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined|Material+Icons+Two+Tone|Material+Icons+Round|Material+Icons+Sharp"
      rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <!-- <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" /> -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.4.6/css/swiper.min.css" /> -->
    <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css"/>
    <link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vanillajs-datepicker@1.1.4/dist/css/datepicker.min.css">
    <link rel="stylesheet" href="https://cdn.rawgit.com/ConnorAtherton/loaders.css/master/loaders.min.css">
    <link rel="stylesheet" href="./assets/style/all.css">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NQSRC5L10W"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-NQSRC5L10W');
    </script>
  </head>

  <body>
    <!-- 導覽列 -->
    <nav class="navbar navbar-expand-lg navbar-light border-bottom | py-4 py-lg-5">
      <div class="container">
        <!-- 台灣走走 TaiWalk-logo -->
        <a class="navbar-brand mx-auto mx-lg-0" href="./index.html">
          <img class="d-none d-lg-block" src="./assets/images/Logo-desktop.png" alt="台灣走走 Tai Walk" width="241px" height="32px">
          <img class="d-block d-lg-none" src="./assets/images/Logo-mobile.png" alt="台灣走走 Tai Walk" width="118px" height="30px">
        </a>
        <!-- 漢堡 -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <!-- <span class="navbar-toggler-icon"></span> -->
          <!-- <span class="material-icons-outlined text-white">
            menu
          </span> -->
          <div class="burger burger1">
            <div></div>
          </div>
        </button>
        <!-- 選單內容 -->
        <div class="collapse navbar-collapse flex-grow-0" id="navbarSupportedContent">
          <ul class="navbar-nav">
            <li class="nav-item | me-4">
              <a class="nav-link text-secondary | hvr-underline-from-center" aria-current="page" href="./scenicSpot.html">
                探索景點
              </a>
            </li>
            <li class="nav-item | me-4">
              <a class="nav-link text-secondary | hvr-underline-from-center" href="./activity.html">
                節慶活動
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link text-secondary | hvr-underline-from-center" aria-current="page" href="./foodSpot.html">
                品嚐美食
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- main 主內容區 -->

    <main class="container | pt-7 pt-lg-12 pb-13 pb-lg-19">
      
      
<div class="container">
    <div class="scenicSpot_Breadcrumb text-primary | mb-4 mb-lg-9">
        <a href="index.html">首頁</a> / 
        <a href="./scenicSpot.html">
            <span class="breadcrumb_theme text-secondary">探索景點</span>
        </a>
        <span class="breadcrumb_city text-primary"></span>
        <span class="breadcrumb_location text-secondary"></span>
    </div>
</div>
<section>
    <div class="container">
        <div class="scenicSpot_resultArea">
            <!-- 搜尋列 -->
            <div class="row | mb-6 mb-lg-11">
                <div class="col-12 col-lg-3">
                    <select class="search_city form-select | mb-2" aria-label="select">
                        <option value="all" selected>全部縣市</option>
                        <option value="Taipei">臺北市</option>
                        <option value="NewTaipei">新北市</option>
                        <option value="Taoyuan">桃園市</option>
                        <option value="Taichung">臺中市</option>
                        <option value="Tainan">臺南市</option>
                        <option value="Kaohsiung">高雄市</option>
                        <option value="Keelung">基隆市</option>
                        <option value="Hsinchu">新竹市</option>
                        <option value="HsinchuCounty">新竹縣</option>
                        <option value="MiaoliCounty">苗栗縣</option>
                        <option value="ChanghuaCounty">彰化縣</option>
                        <option value="NantouCounty">南投縣</option>
                        <option value="YunlinCounty">雲林縣</option>
                        <option value="ChiayiCounty">嘉義縣</option>
                        <option value="Chiayi">嘉義市</option>
                        <option value="PingtungCounty">屏東縣</option>
                        <option value="YilanCounty">宜蘭縣</option>
                        <option value="HualienCounty">花蓮縣</option>
                        <option value="TaitungCounty">臺東縣</option>
                        <option value="KinmenCounty">金門縣</option>
                        <option value="PenghuCounty">澎湖縣</option>
                        <option value="LienchiangCounty">連江縣</option>
                    </select>
                </div>
                <div class="col-12 col-lg-6">
                    <input class="search_keyword form-control | mb-2" type="text" placeholder="你想去哪裡？請輸入關鍵字" aria-label="你想去哪裡？請輸入關鍵字">
                </div>
                <div class="col-12 col-lg-3">
                    <button type="submit" class="search_submit btn btn-success text-white w-100">
                        <i class="fa fa-search | me-4" aria-hidden="true"></i>
                        搜&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;尋
                    </button>
                </div>
            </div>

            <!-- 主題分類區 -->
            <h5 class="fz-6 fz-lg-9 text-dark fw-light | mb-4 mb-lg-5">熱門主題</h5>
            <div class="scenicSpot_showResultClass | row">
                <div class="col-6 col-md-4 col-lg-3"></div>
            </div>
        </div>

        <div class="scenicSpot_showSpotArea d-none">
            <!-- 結果呈現區 -->

            <!-- Hero Banner Swiper -->
            <div class="mb-6 mb-lg-9">
                <div class="container">
                    <div class="scenicSpot_heroSwiper | swiper swiper-initialized swiper-horizontal swiper-pointer-events swiper-css-mode">
                        <ul class="swiper-wrapper">
                            <!-- 第一張 -->
                            <li class="swiper-slide unselectable">
                                <img src="" alt="">
                            </li>
                            <!-- 第二張 -->
                            <li class="swiper-slide unselectable">
                                <img src="" alt="">
                            </li>
                            <!-- 第三張 -->
                            <li class="swiper-slide unselectable">
                                <img src="" alt="">
                            </li>
                        
                        </ul>

                        <!-- swiper-pagination -->
                        <div class="swiper-button-next | d-none d-lg-block | me-7" tabindex="0" role="button" aria-label="Next slide" aria-controls="swiper-wrapper-7ed39f2addecc58d" aria-disabled="false">
                            <img src="./assets/images/Arrow-Right.png" alt="Arrow-Right">
                        </div>
                        <div class="swiper-button-prev | d-none d-lg-block | ms-7" tabindex="-1" role="button" aria-label="Previous slide" aria-controls="swiper-wrapper-7ed39f2addecc58d" aria-disabled="true">
                            <img src="./assets/images/Arrow-Left.png" alt="Arrow-Left">
                        </div>
                        <div class="swiper-pagination swiper-pagination-bullets swiper-pagination-horizontal"></div>

                    </div>
                </div>
            </div>

            <!-- 景點介紹 -->
            <h1 class="fz-6 fz-lg-9 text-dark fw-light | mb-2 mb-lg-4">
                景點
            </h1>
            <h2 class="mb-5 mb-lg-8">
                <span class="btn btn-outline-info rounded-pill | fz-3 fz-lg-5"># Class</span>
            </h2>

            <h4 class="fz-4 fz-lg-5 text-dark fw-bold | mb-3">景點介紹：</h4>
            <h3 class="spot_description | fz-4 fz-lg-5 fw-light | mb-8 mb-lg-12">
                介紹
            </h3>

            <!-- 景點相關資訊 -->
            <div class="row | mb-12">
                <div class="spot_info col-12 col-lg-6 h-100">
                    <table>
                        <tbody valign="top">
                            <tr>
                                <td width="20%" class="fz-4 fw-bold">開放時間：</td>
                                <td class="scenicSpot_resultTime">
                                    Time
                                </td>
                            </tr>
                            <tr>
                                <td class="fz-4 fw-bold">服務電話：</td>
                                <td class="scenicSpot_resultPhone">
                                    Phone
                                </td>
                            </tr>
                            <tr>
                                <td class="fz-4 fw-bold">景點地址：</td>
                                <td class="scenicSpot_resultAddress">
                                    Address
                                </td>
                            </tr>
                            <tr>
                                <td class="fz-4 fw-bold">官方網站：</td>
                                <td class="scenicSpot_resultWeb">
                                    WebsiteUrl
                                </td>
                            </tr>
                            <tr>
                                <td class="fz-4 fw-bold">票價資訊：</td>
                                <td class="scenicSpot_resultTicket">
                                    Ticket
                                </td>
                            </tr>
                            <tr>
                                <td class="fz-4 fw-bold">注意事項：</td>
                                <td class="scenicSpot_resultRemark">
                                    Remarks
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="spot_relatedInfo col-12 col-lg-6">
                    <div class="spot_map | rounded-4 overflow-hidden | mb-5 mb-lg-8">
                        <iframe 
                            width="100%" 
                            height="230" 
                            frameborder="0"
                            src="https://www.google.com/maps?q=(羅東林業文化園區)&hl=zh-TW&z=16&t=&output=embed">
                        </iframe>
                    </div>
                    
                    <h5 class="fz-4 fz-lg-5 text-dark fw-bold | mb-3">周邊資訊：</h5>
                    <div class="row">
                        <div class="col-12 col-lg-4 g-30">
                            <div class="border border-light bg-white rounded-3 text-center | py-4 px-9">
                                <a class="d-flex flex-column ai-c" href="#">
                                    <img class="nearbyIcon" src="./assets/images/nearby-scene30.png" height="30px" width="30px" alt="nearby-scene">
                                    <img class="nearbyIcon_hover" src="./assets/images/nearby-scene30_hover.png" height="30px" width="30px" alt="nearby-scene">
                                    <p class="text-primary fz-4 fw-bold">
                                        附近景點
                                    </p>
                                </a>
                            </div>
                        </div>
                        <div class="col-12 col-lg-4 g-30">
                            <div class="border border-light bg-white rounded-3 text-center | py-4 px-9">
                                <a class="d-flex flex-column ai-c" href="#">
                                    <img class="nearbyIcon" src="./assets/images/nearby-event30.png" height="30px" width="30px" alt="nearby-scene">
                                    <img class="nearbyIcon_hover" src="./assets/images/nearby-event30_hover.png" height="30px" width="30px" alt="nearby-scene">
                                    <p class="text-primary fz-4 fw-bold">
                                        附近活動
                                    </p>
                                </a>
                            </div>
                        </div>
                        <div class="col-12 col-lg-4 g-30">
                            <div class="border border-light bg-white rounded-3 text-center | py-4 px-9">
                                <a class="d-flex flex-column ai-c" href="#">
                                    <img class="nearbyIcon" src="./assets/images/nearby-food30.png" height="30px" width="30px" alt="nearby-scene">
                                    <img class="nearbyIcon_hover" src="./assets/images/nearby-food30_hover.png" height="30px" width="30px" alt="nearby-scene">
                                    <p class="text-primary fz-4 fw-bold">
                                        附近美食
                                    </p>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            
            <!-- 還有這些不能錯過 -->
            <div class="mb-9">
                <div class="container">
                    <div class="d-flex jc-sb ai-c | mb-3">
                        <h4 class="fz-6 fz-lg-9 text-dark fw-light">還有這些不能錯過</h4>
                        <h5>
                            <a class="fz-4 fw-medium text-warning" href="./scenicSpot.html">
                                查看更多景點 ❯
                            </a>
                        </h5>
                    </div>
                    <div class="row">
                        <!-- 手機版/平板顯示 swiper -->
                        <div class="col-12 | overflow-hidden">
                            <div class="scenicSpotSwiper swiper-container">
                                <div class="recommend_scenicSpot | swiper-wrapper"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </div>

    </div>
</section>


<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.4/axios.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jsSHA/3.2.0/sha.js"></script>
<script>
    // header 驗證
    function getAuthorizationHeader() {
        let AppID = '9eeb30e3588740618367a446631cbc3f';
        let AppKey = 'CKTwBadJd3_0_EdqiXE0kEg8fTw';
        let GMTString = new Date().toGMTString();
        let ShaObj = new jsSHA('SHA-1', 'TEXT');
        ShaObj.setHMACKey(AppKey, 'TEXT');
        ShaObj.update('x-date: ' + GMTString);
        let HMAC = ShaObj.getHMAC('B64');
        let Authorization = 'hmac username=\"' + AppID + '\", algorithm=\"hmac-sha1\", headers=\"x-date\", signature=\"' + HMAC + '\"';
        return { 'Authorization': Authorization, 'X-Date': GMTString }; 
    }

    // endpoints
    const endpoint_Scenic = 'https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot/?$filter=Picture/PictureUrl1 ne null&$format=JSON';

    // 抓取畫面物件
    const scenicSpot_showResultClass = document.querySelector('.scenicSpot_showResultClass');
    const scenicSpot_resultArea = document.querySelector('.scenicSpot_resultArea');
    const scenicSpot_showSpotArea = document.querySelector('.scenicSpot_showSpotArea');

    // 探索景點 ScenicSpot 熱門主題分類：取得資料 & 渲染畫面
    function scenicSpot_getClass(){
        axios.get(endpoint_Scenic,
            {
            headers: getAuthorizationHeader()
            }
        )
        .then(function (response) {
            const thisData = response.data;
            
            // 過濾資料的景點類別
            let ScenicSpot_class1 = [];
            let ScenicSpot_class2 = [];
            let ScenicSpot_class3 = [];
            thisData.forEach(el => {
                if(el.Picture.PictureUrl1 && el.ScenicSpotName && el.Class1) ScenicSpot_class1.push({class:el.Class1,item:el});
                if(el.Picture.PictureUrl1 && el.ScenicSpotName && el.Class2) ScenicSpot_class2.push({class:el.Class2,item:el});
                if(el.Picture.PictureUrl1 && el.ScenicSpotName && el.Class3) ScenicSpot_class3.push({class:el.Class3,item:el});
            });

            // 將景點類別進行分類與計數
            let ScenicSpot_class = new Set();
            ScenicSpot_class1.forEach(el=>ScenicSpot_class.add(el.class));
            ScenicSpot_class2.forEach(el=>ScenicSpot_class.add(el.class));
            ScenicSpot_class3.forEach(el=>ScenicSpot_class.add(el.class));
            console.log(Array.from(ScenicSpot_class));

            let str="";
            let itemNum = 0;
            while(itemNum<Array.from(ScenicSpot_class).length){
                const newArr = ScenicSpot_class1.filter(el=>el.class===Array.from(ScenicSpot_class)[itemNum])
                        .concat(ScenicSpot_class2.filter(el=>el.class===Array.from(ScenicSpot_class)[itemNum]))
                        .concat(ScenicSpot_class3.filter(el=>el.class===Array.from(ScenicSpot_class)[itemNum]));
                let dataIndex= Math.floor(Math.random()*newArr.length);
                str+=`
                <div class="scenicClass_Card col-6 col-md-4 col-lg-3 | position-relative">
                    <div class="ratio ratio-16x9 rounded-4 | overflow-hidden | mb-3">
                        <a href="#"  onclick="select_class('${Array.from(ScenicSpot_class)[itemNum]}');">
                            <img class="img-cover" src="${newArr[dataIndex].item.Picture.PictureUrl1}" alt="${newArr[dataIndex].item.ScenicSpotName}">
                        </a>
                    </div>
                    <p class="text-white fz-4 fz-lg-5 fw-bold | position-absolute top-50 start-50 translate-middle">${Array.from(ScenicSpot_class)[itemNum]}</p>
                </div>`;
                itemNum++;
            }
            scenicSpot_showResultClass.innerHTML = str;
        })
        .catch(function (error) {
            console.log(error);
        }); 
    }
    

    // 抓取畫面物件
    const breadcrumb_theme = document.querySelector('.breadcrumb_theme');
    const breadcrumb_city = document.querySelector('.breadcrumb_city');
    const breadcrumb_location = document.querySelector('.breadcrumb_location');
    const scenicSpot_heroSwiperSlides = document.querySelectorAll('.swiper-slide');
    const scenicSpot_heroBullets = document.querySelector('.swiper-pagination-bullets');
    const scenicSpot_resultName = document.getElementsByTagName('h1')[0];
    const scenicSpot_resultClass = document.getElementsByTagName('h2')[0];
    const scenicSpot_resultDescription = document.querySelector('.spot_description');
    const scenicSpot_resultTime = document.querySelector('.scenicSpot_resultTime');
    const scenicSpot_resultPhone = document.querySelector('.scenicSpot_resultPhone');
    const scenicSpot_resultAddress = document.querySelector('.scenicSpot_resultAddress');
    const scenicSpot_resultWeb = document.querySelector('.scenicSpot_resultWeb');
    const scenicSpot_resultTicket = document.querySelector('.scenicSpot_resultTicket');
    const scenicSpot_resultRemark = document.querySelector('.scenicSpot_resultRemark');
    const spot_map = document.querySelector('.spot_map');

    // 抓取畫面物件
    const recommend_scenicSpot = document.querySelector('.recommend_scenicSpot');

    // 推薦其他不能錯過的景點
    function recommend_showScenicSpot(city){
        axios.get(endpoint_Scenic,
            {
            headers: getAuthorizationHeader()
            }
        )
        .then(function (response) {
            const thisData = response.data;
            const recommendData = thisData.filter(el=>el.City===city);
            console.log(recommendData);
            let str="";
            let strNum = 0;
            while(strNum<4){
                let dataIndex= Math.floor(Math.random()*recommendData.length);
                const item = recommendData[dataIndex];
                if(item.ScenicSpotName && item.Picture.PictureUrl1 && item.Address){
                    str+=`
                    <div class="swiper-slide unselectable">
                        <div class="ratio ratio-13x10 rounded-4 | overflow-hidden | mb-3">
                            <a href="./scenicSpot.html?id=${item.ScenicSpotID}">
                                <img class="w-100 h-100 img-cover" src="${item.Picture.PictureUrl1}" alt="${item.ScenicSpotName}">    
                            </a>
                        </div>
                        <h5 class="ellipsis | fz-4 fz-lg-5 | mb-2">${item.ScenicSpotName}</h5>
                        <p class="card-text text-secondary | fz-3 fz-lg-4">
                            <small>
                                <img src="./assets/images/spot16.png" alt="spot icon">
                                ${item.Address.slice(0,3)}
                            </small>
                        </p>
                    </div>`
                    strNum++;
                }
            }
            recommend_scenicSpot.innerHTML = str;
        })
        .catch(function (error) {
            console.log(error);
        }); 
    }


    
    // 探索景點 ScenicSpot 展示景點資訊：取得資料 & 渲染畫面
    function scenicSpot_showSpot(id){
        axios.get(endpoint_Scenic,
            {
            headers: getAuthorizationHeader()
            }
        )
        .then(function (response) {
            const thisData = response.data;

            // 搜尋ID，取得景點資料
            let targetInfo = thisData.filter(el=>el.ScenicSpotID===id);
            console.log(targetInfo[0]);

            // 更改麵包屑
            breadcrumb_theme.classList.remove('text-secondary');
            breadcrumb_theme.classList.add('text-primary');
            breadcrumb_city.innerHTML = ` / ${targetInfo[0].City}`;
            breadcrumb_location.innerHTML = ` / ${targetInfo[0].Name}`;

            // Hero 加入景點照片
            let heroPhoto_num = 0;
            if(targetInfo[0].Picture.PictureUrl1){
                scenicSpot_heroSwiperSlides[0].innerHTML=`
                    <img class="w-100 h-100 img-cover" src="${targetInfo[0].Picture.PictureUrl1}" alt="${targetInfo[0].Picture.PictureDescription1}">`;
                heroPhoto_num++;
            }else{
                scenicSpot_heroSwiperSlides[0].innerHTML=`
                    <img class="w-100 h-100 img-cover" src="./assets/images/noPicture.png" alt="${targetInfo[0].Picture.PictureDescription1}">`;
                heroPhoto_num++;
            }
            if(targetInfo[0].Picture.PictureUrl2){
                scenicSpot_heroSwiperSlides[1].innerHTML=`
                    <img class="w-100 h-100 img-cover" src="${targetInfo[0].Picture.PictureUrl2}" alt="${targetInfo[0].Picture.PictureDescription2}">`;
                heroPhoto_num++;
            }else{
                scenicSpot_heroSwiperSlides[1].remove();
                scenicSpot_heroBullets.classList.add('d-none');
            }
            if(targetInfo[0].Picture.PictureUrl3){
                scenicSpot_heroSwiperSlides[2].innerHTML=`
                    <img class="w-100 h-100 img-cover" src="${targetInfo[0].Picture.PictureUrl3}" alt="${targetInfo[0].Picture.PictureDescription3}">`;
                heroPhoto_num++;
            }else{
                scenicSpot_heroSwiperSlides[2].remove();
                scenicSpot_heroBullets.classList.add('d-none');
            }
            if(heroPhoto_num<=1){
                document.querySelector('.swiper-button-next').classList.add('d-lg-none');
                document.querySelector('.swiper-button-prev').classList.add('d-lg-none');
            }

            // 添加景點名稱
            scenicSpot_resultName.innerText = targetInfo[0].Name;

            // 添加景點類別 Class
            let classStr="";
            if(targetInfo[0].Class1){
                classStr+=`
                <span class="btn btn-outline-info rounded-pill | fz-3 fz-lg-5">
                    # ${targetInfo[0].Class1}
                </span>`;
            } 
            if(targetInfo[0].Class2){
                classStr+=`
                <span class="btn btn-outline-info rounded-pill | fz-3 fz-lg-5">
                    # ${targetInfo[0].Class2}
                </span>`;
            }
            if(targetInfo[0].Class3){
                classStr+=`
                <span class="btn btn-outline-info rounded-pill | fz-3 fz-lg-5">
                    # ${targetInfo[0].Class3}
                </span>`;
            }
            scenicSpot_resultClass.innerHTML=classStr;

            // 添加景點介紹
            scenicSpot_resultDescription.innerText = targetInfo[0].DescriptionDetail;

            // 景點開放時間
            scenicSpot_resultTime.innerText = targetInfo[0].OpenTime;

            // 景點連絡電話
            scenicSpot_resultPhone.innerHTML = `
                <a href="tel:${targetInfo[0].Phone}">
                    ${targetInfo[0].Phone}
                </a>`;

            // 景點地址
            scenicSpot_resultAddress.innerText = targetInfo[0].Address;

            // 景點官方網站
            if(targetInfo[0].WebsiteUrl){
                scenicSpot_resultWeb.innerHTML = `
                <a href="${targetInfo[0].WebsiteUrl}" target="_blank">
                    ${targetInfo[0].WebsiteUrl}
                </a>`;
            } else {
                scenicSpot_resultWeb.innerText = "無";
            }

            // 景點票價
            if(targetInfo[0].TicketInfo){
                scenicSpot_resultTicket.innerText = targetInfo[0].TicketInfo;
            } else {
                scenicSpot_resultTicket.innerText = "無";
            }

            // 景點注意事項
            if(targetInfo[0].Remarks){
                scenicSpot_resultRemark.innerText = targetInfo[0].Remarks;
            } else {
                scenicSpot_resultRemark.innerText = "無";
            }

            // 景點地圖
            spot_map.innerHTML = `
                <iframe 
                    width="100%" 
                    height="230" 
                    frameborder="0"
                    src="https://www.google.com/maps?q=${targetInfo[0].Address}(${targetInfo[0].Name})&hl=zh-TW&z=15&t=&output=embed">
                </iframe>`;

            // 顯示 scenicSpot_showSpotArea 區塊
            scenicSpot_showSpotArea.classList.remove('d-none');

            // 推薦其他不能錯過的景點
            recommend_showScenicSpot(targetInfo[0].City);

        })
        .catch(function (error) {
            console.log(error);
        }); 
    }

    
    // 景點類別
    function select_class(iClass){
        console.log(iClass);
        axios.get(endpoint_Scenic,
            {
            headers: getAuthorizationHeader()
            }
        )
        .then(function (response) {
            scenicSpot_resultArea.classList.add('d-none');
            const thisData = response.data;
            let resultData = new Set();
            const resultData1 = thisData.filter(el => el.Class1==iClass);
            const resultData2 = thisData.filter(el => el.Class2==iClass);
            const resultData3 = thisData.filter(el => el.Class3==iClass);
            resultData1.forEach(el=>resultData.add(el));
            resultData2.forEach(el=>resultData.add(el));
            resultData3.forEach(el=>resultData.add(el));
            resultData = Array.from(resultData);
            console.log(resultData);
            let str=`
                <h5 class="fz-6 fz-lg-9 text-dark fw-light | mb-4 mb-lg-5">
                    搜尋結果
                    <span class="fz-4 text-dark fw-light | ms-2">
                        共有 <small class="text-warning">${resultData.length}</small> 筆
                    </span>
                </h5>
                <div class="row">`;
            let strNum = 0;
            while(strNum<resultData.length){
                resultData.forEach((item)=>{
                    if(item.Picture.PictureUrl1){
                        str+=`
                        <div class="col-12 col-lg-3 | mb-5 mb-lg-8">
                            <div class="ratio ratio-13x10 rounded-4 | overflow-hidden | mb-3">
                                <a href="./scenicSpot.html?id=${item.ScenicSpotID}">
                                    <img class="w-100 h-100 img-cover" src="${item.Picture.PictureUrl1}" alt="${item.ScenicSpotName}">    
                                </a>
                            </div>
                            <h5 class="ellipsis | fz-4 fz-lg-5 | mb-2">${item.ScenicSpotName}</h5>
                            <p class="card-text text-secondary | fz-3 fz-lg-4">
                                <small>
                                    <img src="./assets/images/spot16.png" alt="spot icon">
                                    ${item.City?item.City:item.Address.slice(0,3)}
                                </small>
                            </p>
                        </div>`
                    }else{
                        str+=`
                        <div class="col-12 col-lg-3 | mb-5 mb-lg-8">
                            <div class="ratio ratio-13x10 rounded-4 | overflow-hidden | mb-3">
                                <a href="./scenicSpot.html?id=${item.ScenicSpotID}">
                                    <img class="w-100 h-100 img-cover" src="./assets/images/noPicture.png" alt="${item.ScenicSpotName}">    
                                </a>
                            </div>
                            <h5 class="ellipsis | fz-4 fz-lg-5 | mb-2">${item.ScenicSpotName}</h5>
                            <p class="card-text text-secondary | fz-3 fz-lg-4">
                                <small>
                                    <img src="./assets/images/spot16.png" alt="spot icon">
                                    ${item.City?item.City:item.Address.slice(0,3)}
                                </small>
                            </p>
                        </div>`
                    }
                    strNum++;
                });
            }
            str+=`</div>`;
            scenicSpot_showSpotArea.innerHTML = str;

            // 顯示 scenicSpot_showSpotArea 區塊
            scenicSpot_showSpotArea.classList.remove('d-none');
            console.log(str);
        })
        .catch(function (error) {
            console.log(error);
        }); 

    }
    
    // 關鍵字搜尋
    const search_city = document.querySelector('.search_city');
    const search_keyword = document.querySelector('.search_keyword');
    const search_submit = document.querySelector('.search_submit');
    function search_scenicSpot(city,keyword){
        console.log('search');
        axios.get(`https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot/${city}?$filter=Picture/PictureUrl1 ne null&$format=JSON`,
            {
            headers: getAuthorizationHeader()
            }
        )
        .then(function (response) {
            scenicSpot_resultArea.classList.add('d-none');
            const thisData = response.data;
            const resultData = thisData.filter(el => el.ScenicSpotName.includes(keyword));
            console.log(resultData);
            let str=`
                <h5 class="fz-6 fz-lg-9 text-dark fw-light | mb-4 mb-lg-5">
                    搜尋結果
                    <span class="fz-4 text-dark fw-light | ms-2">
                        共有 <small class="text-warning">${resultData.length}</small> 筆
                    </span>
                </h5>
                <div class="row">`;
            let strNum = 0;
            while(strNum<resultData.length){
                resultData.forEach((item)=>{
                    if(item.Picture.PictureUrl1){
                        str+=`
                        <div class="col-12 col-lg-3 | mb-5 mb-lg-8">
                            <div class="ratio ratio-13x10 rounded-4 | overflow-hidden | mb-3">
                                <a href="./scenicSpot.html?id=${item.ScenicSpotID}">
                                    <img class="w-100 h-100 img-cover" src="${item.Picture.PictureUrl1}" alt="${item.ScenicSpotName}">    
                                </a>
                            </div>
                            <h5 class="ellipsis | fz-4 fz-lg-5 | mb-2">${item.ScenicSpotName}</h5>
                            <p class="card-text text-secondary | fz-3 fz-lg-4">
                                <small>
                                    <img src="./assets/images/spot16.png" alt="spot icon">
                                    ${item.City?item.City:item.Address.slice(0,3)}
                                </small>
                            </p>
                        </div>`
                    }else{
                        str+=`
                        <div class="col-12 col-lg-3 | mb-5 mb-lg-8">
                            <div class="ratio ratio-13x10 rounded-4 | overflow-hidden | mb-3">
                                <a href="./scenicSpot.html?id=${item.ScenicSpotID}">
                                    <img class="w-100 h-100 img-cover" src="./assets/images/noPicture.png" alt="${item.ScenicSpotName}">    
                                </a>
                            </div>
                            <h5 class="ellipsis | fz-4 fz-lg-5 | mb-2">${item.ScenicSpotName}</h5>
                            <p class="card-text text-secondary | fz-3 fz-lg-4">
                                <small>
                                    <img src="./assets/images/spot16.png" alt="spot icon">
                                    ${item.City?item.City:item.Address.slice(0,3)}
                                </small>
                            </p>
                        </div>`
                    }
                    strNum++;
                });
            }
            str+=`</div>`;
            scenicSpot_showSpotArea.innerHTML = str;

            // 顯示 scenicSpot_showSpotArea 區塊
            scenicSpot_showSpotArea.classList.remove('d-none');
            console.log(str);
        })
        .catch(function (error) {
            console.log(error);
        }); 

    }


    // 按鈕監聽
    search_submit.addEventListener('click',()=>{
        if(search_city.value==='all') search_city.value='';
        if(search_keyword.value==='') alert('請輸入想要查詢的關鍵字');
        if(search_keyword.value) {
            scenicSpot_resultArea.classList.add('d-none');
            search_scenicSpot(search_city.value,search_keyword.value);
        }
    });

    // 判斷初始狀況
    if(!location.search){
        scenicSpot_getClass();
    } else {
        scenicSpot_resultArea.classList.add('d-none');
        const arr1 = location.search.split('?');
        let id;
        let city;
        let keyword;
        console.log(arr1);
        if(!arr1[1].includes('&')){
            id = arr1[1].split('=')[1];
            scenicSpot_showSpot(id);
        } else{
            city = arr1[1].split('&')[0].split('=')[1];
            keyword = arr1[1].split('&')[1].split('=')[1];
            if(keyword.includes('+encodeURIComponent')){
                keyword = decodeURIComponent(keyword.split('+encodeURIComponent(')[1].split(')')[0]);
                console.log(keyword);
            } else{
                keyword = arr1[1].split('&')[1].split('=')[1];
            }
            console.log(keyword);
            search_scenicSpot(city,keyword);
        }
    }

</script>

    </main>

    
    <!-- footer 頁尾 -->
    <footer class="bg-footer">
      <div class="container | d-flex ai-c jc-c | py-5">
        <!-- Copyright -->
        <div class="d-flex align-self-end">
          <p class="h6 text-white | d-none d-md-block">The F2E © 2021. # Code: Sylvia-H / Design: Breakfast</p>
          <p class="h6 text-white text-center | d-block d-md-none">The F2E © 2021. # Code: Sylvia-H / Design: Breakfast</p>
        </div>
      </div>
    </footer>



    <!-- script -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanillajs-datepicker@1.1.4/dist/js/datepicker-full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.4/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsSHA/3.2.0/sha.js"></script>
    <script src="./assets/js/vendors.js"></script>
    <script src="./assets/js/all.js"></script>
  </body>

</html>